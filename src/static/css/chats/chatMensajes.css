/* HEADER en grid */
.chat-head{
  position: relative;
  display: grid;
  grid-template-columns: auto 1fr auto;
  align-items: center;
  gap: 8px;
  padding: 8px 10px;
  border-bottom: 1px solid var(--border);
  min-height: 42px;
  z-index: 10;              /* por encima de fondos/paneles */
}

/* botón */
.toggle-ambitos{
  grid-column: 1;
  display:inline-flex;align-items:center;justify-content:center;
  width:32px;height:32px;border:1px solid var(--border);border-radius:8px;
}

/* ⚠️ RESET del absolute heredado */
.chat-head .ctx-badge{
  position: static !important;   /* quita absolute */
  inset: auto !important;
  transform: none !important;
  grid-column: 2;
  justify-self: center;          /* centro X */
  align-self: center;            /* centro Y */
  max-width: calc(100% - 80px);  /* margen por botón/gaps, evita desborde */
  min-width: 0;
  z-index: 11;                   /* por delante de líneas/sombras */
}

/* truncado en una línea */
.ctx-badge .ctx-pill{
  display:block; max-width:100%;
  overflow:hidden; white-space:nowrap; text-overflow:ellipsis;
}

/* placeholder derecho para simetría (opcional) */
.chat-head::after{
  content:""; grid-column:3; width:32px; height:1px;
}

.toggle-ambitos {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  border: 1px solid var(--border);
  border-radius: 8px;
  background: #0b1426;
  color: #ffffff !important;   /* ← fuerza el color blanco */
  font-weight: bold;
  cursor: pointer;
  z-index: 2;
  transition: background 0.2s, color 0.2s;
}

.toggle-ambitos:hover {
  background: #1e293b;         /* tono más claro al pasar el mouse */
  color: #00e0ff;              /* efecto visual elegante en hover */
}


/* Badge básico (ajustá a tu estilo si ya lo tenés) */
.ctx-badge{
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 6px 12px;
  border: 1px solid var(--border);
  border-radius: 999px;
  background: #0b1426;
  color: #cbd5e1;
  font-weight: 600;
  line-height: 1;
  max-width: 100%;
  white-space: nowrap;
}


/* Mata cualquier barra/acentos heredados */
.ctx-badge,
.ctx-badge *{
  background-image: none !important;  /* si venía de un gradient */
  border-left: 0 !important;          /* si era un borde */
  box-shadow: none !important;        /* si era un glow “aplastado” */
}

/* Apaga cualquier pseudo que siga dibujando algo */
.ctx-badge::before,
.ctx-badge::after,
.ctx-badge *::before,
.ctx-badge *::after{
  content: none !important;
  display: none !important;
}

.ctx-badge{
  display:inline-flex; align-items:center; gap:8px;
  padding:6px 12px;
  background:#0b1426 !important;   /* asegura solo color, sin imagen */
  color:#cbd5e1; border:1px solid var(--border);
  border-radius:999px;
  max-width:100%; min-width:0; white-space:nowrap;
}


/* El contenedor padre (columna) debe permitir que el hijo scrollee */
.col-chat, .chat-wrapper, .content-col {
  height: 100%;
  min-height: 0;          /* CLAVE */
  overflow: hidden;
}

/* Chat: header / mensajes (1fr) / input */
.chat{
  display: grid;
  grid-template-rows: auto 1fr auto;
  height: 100%;
  max-height: 100%;
  border: 1px solid var(--border);
  border-radius: 12px;        /* o 0 si lo querés cuadrado */
  background: #0b1222;
  overflow: hidden;           /* el scroll vive en .msgs */
}

/* Header ya lo tenés; lo dejo por si falta min-altura */
.chat-head{
  min-height: 42px;
  border-bottom: 1px solid var(--border);
  background: inherit;
}

/* Lista scrolleable y sin solaparse con el input */
.msgs{
  min-height: 0;             /* CLAVE para que scrollee */
  overflow: auto;
  padding: 12px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

/* Input fijo en el fondo */
.chat-input{
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 8px;
  padding: 8px;
  border-top: 1px solid var(--border);
  background: inherit;
}
.chat-input input{
  background:#0b1426; border:1px solid var(--border);
  border-radius:10px; padding:10px; color:#cbd5e1;
}


/* 0) Config general: bloqueá el scroll global si querés scrollear solo el chat */
html, body { height: 100%; overflow: hidden; }

/* 1) Viewport útil con topbar fijo (ajustá la altura real) */
:root { --topbar-h: 70px; } /* si tu topbar mide 64px, poné 64 */

/* 2) Columnas/padres sin “trabar” el alto de sus hijos */
.app, .layout, .content, .col-chat {
  height: 100dvh;
  min-height: 0;
  overflow: hidden;
}
/* Fallback si 100dvh no está soportado */
@supports not (height: 100dvh) {
  .app, .layout, .content, .col-chat { height: 100vh; }
}

/* 3) Que la columna del chat reste el topbar y no tenga overflow propio */
.col-chat {
  height: calc(100dvh - var(--topbar-h));
  min-height: 0;
  overflow: hidden;
}
@supports not (height: 100dvh) {
  .col-chat { height: calc(100vh - var(--topbar-h)); }
}

/* 4) El chat se encastra en su columna: header / mensajes / input */
.chat{
  display: grid;
  grid-template-rows: auto 1fr auto;  /* header, lista, input */
  height: 100%;
  max-height: 100%;
  border: 1px solid var(--border);
  border-radius: 12px;                 /* deja 0 si lo querés recto */
  background: #0b1222;
  overflow: hidden;                    /* el único scroll vive en .msgs */
}

/* 5) Header fijo y consistente */
.chat-head{
  min-height: 42px;
  border-bottom: 1px solid var(--border);
  background: inherit;
}

/* 6) La lista de mensajes scrollea dentro del hueco */
.msgs{
  min-height: 0;        /* CLAVE: permite que el grid “aplane” */
  overflow: auto;
  padding: 12px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

/* 7) Input fijo abajo */
.chat-input{
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 8px;
  padding: 8px;
  border-top: 1px solid var(--border);
  background: inherit;
}
.chat-input input{
  background:#0b1426; border:1px solid var(--border);
  border-radius:10px; padding:10px; color:#cbd5e1;
}

/* 8) iOS/Android barras de sistema: evita que tape el input */
@supports (padding: max(0px)) {
  .chat-input { padding-bottom: max(8px, env(safe-area-inset-bottom)); }
}



/* === Layout deslizante para móvil === */
@media (max-width: 768px){

  .layout-chat {                /* tu contenedor general */
    display: flex;
    width: 300%;                /* tres paneles lado a lado */
    transition: transform .4s ease-in-out;
  }

  .col-identidades,
  .col-ambitos,
  .col-chat {
    width: 100%;
    flex-shrink: 0;
    height: 100dvh;
    min-height: 0;
    overflow: hidden;
  }

  /* Estado inicial → muestra Identidades */
  html:not(.slide-ambitos):not(.slide-chat) .layout-chat {
    transform: translateX(0);
  }

  /* Al abrir Ámbitos */
  html.slide-ambitos .layout-chat {
    transform: translateX(-100%);
  }

  /* Al abrir Chat */
  html.slide-chat .layout-chat {
    transform: translateX(-200%);
  }
}


