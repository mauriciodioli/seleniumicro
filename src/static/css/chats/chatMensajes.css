/* HEADER en grid */
.chat-head{
  position: relative;
  display: grid;
  grid-template-columns: auto 1fr auto;
  align-items: center;
  gap: 8px;
  padding: 8px 10px;
  border-bottom: 1px solid var(--border);
  min-height: 42px;
  z-index: 10;              /* por encima de fondos/paneles */
}

/* bot√≥n */
.toggle-ambitos{
  grid-column: 1;
  display:inline-flex;align-items:center;justify-content:center;
  width:32px;height:32px;border:1px solid var(--border);border-radius:8px;
}

/* ‚ö†Ô∏è RESET del absolute heredado */
.chat-head .ctx-badge{
  position: static !important;   /* quita absolute */
  inset: auto !important;
  transform: none !important;
  grid-column: 2;
  justify-self: center;          /* centro X */
  align-self: center;            /* centro Y */
  max-width: calc(100% - 80px);  /* margen por bot√≥n/gaps, evita desborde */
  min-width: 0;
  z-index: 11;                   /* por delante de l√≠neas/sombras */
}

/* truncado en una l√≠nea */
.ctx-badge .ctx-pill{
  display:block; max-width:100%;
  overflow:hidden; white-space:nowrap; text-overflow:ellipsis;
}

/* placeholder derecho para simetr√≠a (opcional) */
.chat-head::after{
  content:""; grid-column:3; width:32px; height:1px;
}

.toggle-ambitos {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  border: 1px solid var(--border);
  border-radius: 8px;
  background: #0b1426;
  color: #ffffff !important;   /* ‚Üê fuerza el color blanco */
  font-weight: bold;
  cursor: pointer;
  z-index: 2;
  transition: background 0.2s, color 0.2s;
}

.toggle-ambitos:hover {
  background: #1e293b;         /* tono m√°s claro al pasar el mouse */
  color: #00e0ff;              /* efecto visual elegante en hover */
}


/* Badge b√°sico (ajust√° a tu estilo si ya lo ten√©s) */
.ctx-badge{
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 6px 12px;
  border: 1px solid var(--border);
  border-radius: 999px;
  background: #0b1426;
  color: #cbd5e1;
  font-weight: 600;
  line-height: 1;
  max-width: 100%;
  white-space: nowrap;
}


/* Mata cualquier barra/acentos heredados */
.ctx-badge,
.ctx-badge *{
  background-image: none !important;  /* si ven√≠a de un gradient */
  border-left: 0 !important;          /* si era un borde */
  box-shadow: none !important;        /* si era un glow ‚Äúaplastado‚Äù */
}

/* Apaga cualquier pseudo que siga dibujando algo */
.ctx-badge::before,
.ctx-badge::after,
.ctx-badge *::before,
.ctx-badge *::after{
  content: none !important;
  display: none !important;
}

.ctx-badge{
  display:inline-flex; align-items:center; gap:8px;
  padding:6px 12px;
  background:#0b1426 !important;   /* asegura solo color, sin imagen */
  color:#cbd5e1; border:1px solid var(--border);
  border-radius:999px;
  max-width:100%; min-width:0; white-space:nowrap;
}


/* El contenedor padre (columna) debe permitir que el hijo scrollee */
.col-chat, .chat-wrapper, .content-col {
  height: 100%;
  min-height: 0;          /* CLAVE */
  overflow: hidden;
}

/* Chat: header / mensajes (1fr) / input */
.chat{
  display: grid;
  grid-template-rows: auto 1fr auto;
  height: 100%;
  max-height: 100%;
  border: 1px solid var(--border);
  border-radius: 12px;        /* o 0 si lo quer√©s cuadrado */
  background: #0b1222;
  overflow: hidden;           /* el scroll vive en .msgs */
}

/* Header ya lo ten√©s; lo dejo por si falta min-altura */
.chat-head{
  min-height: 42px;
  border-bottom: 1px solid var(--border);
  background: inherit;
}

/* Lista scrolleable y sin solaparse con el input */
/* Fondo del panel de mensajes */
.msgs {

  box-sizing: border-box;
  height: 100%;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 4px;           /* menos espacio entre mensajes */
  background: #ebe8c7;
}

/* Mensaje base (burbuja) */
/* GLOBO DE MENSAJE ‚Äì BASE (PC) */
/* =========================
   BURBUJAS DE MENSAJE
   ========================= */

/* Caja externa del mensaje: sin fondo, sin padding */
.msg {
  position: relative;   
  display: flex;
  flex-direction: column;
  align-items: flex-end;      /* los propios a la derecha */
  margin: 6px 8px;
  max-width: 100%;
}

/* Cuerpo de la burbuja (TEXTO por defecto) */
.msg-body {
  max-width: 70%;
  padding: 6px 8px;          /* borde de la burbuja */
  border-radius: 18px;
  box-shadow: 0 1px 2px rgba(0,0,0,0.3);
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  word-wrap: break-word;
  white-space: normal;
}

/* ENVIADOS (yo) */
.msg.me .msg-body {
  margin-left: auto;
  background: #1ee5ff;
  color: #001018;
  border-bottom-right-radius: 4px;
  font-weight: 600;
}

/* RECIBIDOS */
.msg:not(.me) .msg-body {
  margin-right: auto;
  background: #5e5e5e;
  color: #ffffff;
  border-bottom-left-radius: 4px;
  font-weight: 500;
}

/* ===== BURBUJAS DE MEDIA (IMAGEN / VIDEO) ===== */
/* Mismo concepto de burbuja, pero:
   - ancho limitado
   - SIN padding (altura = altura de la imagen/video)
   - sin problemas de l√≠neas vac√≠as (line-height:0) */

/* ===== BURBUJAS DE MEDIA (IMAGEN / VIDEO) ===== */
/* Mismo concepto de burbuja, pero:
   - ancho limitado
   - sin aire raro arriba/abajo
   - color seg√∫n qui√©n env√≠a
*/

/* Burbuja de media */
.msg-body.msg-body-image,
.msg-body.msg-body-video {
  max-width: min(260px, 70vw);
  padding: 4px 4px 22px 4px;   /* üëà dejamos ‚Äúpiso‚Äù para la hora adentro */
  border-radius: 18px;
  box-shadow: 0 1px 2px rgba(0,0,0,0.3);
  overflow: hidden;
  white-space: normal;
  line-height: 0;              /* la imagen/video no generan aire */
}

/* Colores (ya los ten√©s, solo lo recuerdo) */
.msg.me .msg-body.msg-body-image,
.msg.me .msg-body.msg-body-video {
  background: #1ee5ff;
}

.msg:not(.me) .msg-body.msg-body-image,
.msg:not(.me) .msg-body.msg-body-video {
  background: #5e5e5e;
}

/* Pie de foto dentro de la burbuja */
.msg-caption {
  margin-top: 4px;
  padding: 0 2px 1px;
  font-size: 12px;
  line-height: 1.3;        /* aqu√≠ s√≠ texto normal */
  color: inherit;          /* usa el color de la burbuja (celeste/gris) */
  white-space: pre-wrap;   /* respeta saltos de l√≠nea del usuario */
}


/* Hora / meta */
/* Hora / puntito dentro de la burbuja, abajo a la derecha */
.msg-meta {
  position: absolute;
  right: 12px;
  bottom: 4px;                      /* se dibuja sobre el borde inferior de la burbuja */
  margin-top: 0;
  font-size: 11px;
  opacity: 0.7;
  display: flex;
  align-items: center;
  gap: 4px;                         /* espacio entre puntito y hora */
}

/* ====== MOBILE ====== */
/* ====== MOBILE ====== */
@media (max-width: 768px) {
  .msgs {
    padding: 8px;
    gap: 6px;
  }

  .msg-body {
    max-width: 90%;
    font-size: 13px;
  }

  .msg-body.msg-body-image,
  .msg-body.msg-body-video {
    max-width: min(220px, 80vw);
  }
}


/* La hora debajo, pegada a la burbuja */
.msg-meta {
  margin-top: 2px;
  font-size: 11px;
  opacity: 0.7;
  align-self: flex-end;
}

/* Input fijo en el fondo */
.chat-input {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 10px;
  background: #050b15;
  border-top: 1px solid #111827;
}

.chat-input input[type="text"] {
  flex: 1;
  border-radius: 999px;
  border: 1px solid #1f2933;
  background: #000814;
  color: #e5f6ff;
  padding: 8px 12px;
  font-size: 14px;
  outline: none;
}

.chat-input input[type="text"]::placeholder {
  color: #6b7280;
}

.chat-input input[type="text"]:focus {
  border-color: #00bcd4;
}

.chat-btn-send {
  width: 34px;
  height: 34px;
  border-radius: 50%;
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #00bcd4;
  color: #001018;
  font-size: 18px;
  cursor: pointer;
}

.chat-btn-send:active {
  transform: scale(0.96);
}



/* 0) Config general: bloque√° el scroll global si quer√©s scrollear solo el chat */
html, body { height: 100%; overflow: hidden; }

/* 1) Viewport √∫til con topbar fijo (ajust√° la altura real) */
:root { --topbar-h: 70px; } /* si tu topbar mide 64px, pon√© 64 */

/* 2) Columnas/padres sin ‚Äútrabar‚Äù el alto de sus hijos */
.app, .layout, .content, .col-chat {
  height: 100dvh;
  min-height: 0;
  overflow: hidden;
}
/* Fallback si 100dvh no est√° soportado */
@supports not (height: 100dvh) {
  .app, .layout, .content, .col-chat { height: 100vh; }
}

/* 3) Que la columna del chat reste el topbar y no tenga overflow propio */
.col-chat {
  height: calc(100dvh - var(--topbar-h));
  min-height: 0;
  overflow: hidden;
}
@supports not (height: 100dvh) {
  .col-chat { height: calc(100vh - var(--topbar-h)); }
}

/* 4) El chat se encastra en su columna: header / mensajes / input */
.chat{
  display: grid;
  grid-template-rows: auto 1fr auto;  /* header, lista, input */
  height: 100%;
  max-height: 100%;
  border: 1px solid var(--border);
  border-radius: 12px;                 /* deja 0 si lo quer√©s recto */
  background: #0b1222;
  overflow: hidden;                    /* el √∫nico scroll vive en .msgs */
}

/* 5) Header fijo y consistente */
.chat-head{
  min-height: 42px;
  border-bottom: 1px solid var(--border);
  background: inherit;
}

/* 6) La lista de mensajes scrollea dentro del hueco */
.msgs{
  min-height: 0;        /* CLAVE: permite que el grid ‚Äúaplane‚Äù */
  overflow: auto;
  padding: 12px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

/* 7) Input fijo abajo */
.chat-input{
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 8px;
  padding: 8px;
  border-top: 1px solid var(--border);
  background: inherit;
}
.chat-input input{
  background:#0b1426; border:1px solid var(--border);
  border-radius:10px; padding:10px; color:#cbd5e1;
}

/* 8) iOS/Android barras de sistema: evita que tape el input */
@supports (padding: max(0px)) {
  .chat-input { padding-bottom: max(8px, env(safe-area-inset-bottom)); }
}



/* === Layout deslizante para m√≥vil === */
@media (max-width: 768px){

  .layout-chat {                /* tu contenedor general */
    display: flex;
    width: 300%;                /* tres paneles lado a lado */
    transition: transform .4s ease-in-out;
  }

  .col-identidades,
  .col-ambitos,
  .col-chat {
    width: 100%;
    flex-shrink: 0;
    height: 100dvh;
    min-height: 0;
    overflow: hidden;
  }

  /* Estado inicial ‚Üí muestra Identidades */
  html:not(.slide-ambitos):not(.slide-chat) .layout-chat {
    transform: translateX(0);
  }

  /* Al abrir √Åmbitos */
  html.slide-ambitos .layout-chat {
    transform: translateX(-100%);
  }

  /* Al abrir Chat */
  html.slide-chat .layout-chat {
    transform: translateX(-200%);
  }
}









:root{
  /* cu√°nto sube el borde inferior en DESKTOP */
  --panel-gap-bottom: 60px;   /* prob√° 50 / 60 seg√∫n gusto */
}

/* ========= DESKTOP (‚â• 769px) ========= */
@media (min-width: 769px){

  .col-identidades,
  .col-ambitos,
  .col-chat{
    display: flex;
    flex-direction: column;
    min-height: 0;
  }

  /* tarjetas m√°s bajas, pegadas arriba y recortadas abajo */
  .col-identidades .id-card,
  .col-ambitos   .amb-card,
  .col-chat      .chat{
    flex: 1 1 auto;
    height: calc(100% - var(--panel-gap-bottom));
    margin-top: 0;
    margin-bottom: var(--panel-gap-bottom);
  }

  /* scroll interno en listas / mensajes */
  .id-card .id-accordion,
  .amb-card .amb-accordion,
  .chat .msgs{
    min-height: 0;
    overflow: auto;
  }
}

/* ========= MOBILE (‚â§ 768px) ========= */
/* aqu√≠ NO recortamos nada, full-height como antes */
/* === Ajuste SOLO para pantallas peque√±as (chat m√°s arriba) === */
@media (max-width: 768px){

  :root{
    --chat-gap-bottom-mobile: 0;   /* prob√° 40 / 50 / 60 seg√∫n lo que veas */
  }

  /* La columna del chat se vuelve flex para poder ‚Äúrecortar‚Äù abajo */
  .col-chat{
    display: flex;
    flex-direction: column;
    min-height: 0;
  }

  /* El chat queda pegado arriba y se recorta por abajo */
.col-chat .chat {
  display: flex;
  flex-direction: column;
  height: 100%;   /* üëà */
  min-height: 0;  /* üëà */
}


  /* El scroll sigue viviendo dentro de los mensajes */
  .col-chat .chat .msgs{
    min-height: 0;
    overflow: auto;
  }
}






.msg-status-dot {
  display: inline-block;
  width: 11px;              /* m√°s grande */
  height: 11px;
  border-radius: 50%;
  margin-right: 6px;
  vertical-align: middle;
}

/* Colores: iguales pero m√°s visibles */
.msg-status-sent {
  background: #999;         /* enviado */
}

.msg-status-delivered {
  background: #2563eb;      /* entregado */
  box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.35);
}

.msg-status-read {
  background: #22c55e;      /* le√≠do */
  box-shadow: 0 0 0 2px rgba(34, 197, 94, 0.35);
}

/* Meta: fecha m√°s discreta y alineada */
/* Punto + fecha */
.msg-meta {
  margin-top: 2px;
  display: flex;
  justify-content: flex-end;
  align-items: center;
  gap: 4px;                   /* espacio entre punto y fecha */
  font-size: 11px;
  opacity: 0.8;
}

.msg-meta-text {
  font-size: 11px;
  opacity: .8;
}











/* La fila del mensaje sirve de referencia, no cambia tama√±os */
.msg {
  position: relative;
}

/* RESET total del bot√≥n + estilo de icono flotante */
button.msg-menu-btn-icon-mensajes {
  all: unset;                      /* sin estilos heredados raros */
  position: absolute;
  top: 10px;                       /* ajust√° si quer√©s */
  right: 12px;

  width: 18px;
  height: 18px;

  display: flex;
  align-items: center;
  justify-content: center;

  cursor: pointer;
  border-radius: 999px;

  font-size: 16px;
  color: rgba(0, 0, 0, 0.7);

  opacity: 0;                      /* NO ocupa espacio, solo se dibuja encima */
  transition: opacity 0.15s ease, background 0.15s ease;
  background: transparent;
}
.msg-menu-btn-icon-mensajes img {
  border-radius: 0 !important;
  display: block;
  width: 100%;
}

/* Se ve solo al pasar el mouse por la burbuja (desktop) */
.msg:hover button.msg-menu-btn-icon-mensajes {
  opacity: 1;
  background: rgba(0, 0, 0, 0.08);  /* circulito suave tipo WhatsApp */
}

/* Men√∫ desplegable sigue igual */
.msg-menu-dropdown {
  position: absolute;
  top: 30px;
  right: 6px;
  min-width: 140px;
  padding: 4px 0;
  border-radius: 8px;
  background: #fff;
  box-shadow: 0 4px 16px rgba(0,0,0,0.18);
  font-size: 13px;
  z-index: 10;
  display: none;
}
.msg-menu-dropdown.open {
  display: block;
}
.msg-menu-item {
  width: 100%;
  border: none;
  background: transparent;
  text-align: left;
  padding: 6px 10px;
  cursor: pointer;
}
.msg-menu-item:hover {
  background: #f2f4f8;
}
.msg-menu-delete {
  color: #c62828;
}
button.msg-menu-btn-icon-mensajes {
  all: unset;
  position: absolute;
  top: 10px;
  right: 12px;

  width: 18px;
  height: 18px;

  display: flex;
  align-items: center;
  justify-content: center;

  cursor: pointer;
  border-radius: 999px;

  font-size: 14px;     /* un poquito m√°s chico ayuda */
  line-height: 1;      /* <--- clave para centrar el caracter */
  color: rgba(0, 0, 0, 0.7);

  opacity: 0;
  transition: opacity 0.15s ease, background 0.15s ease;
  background: transparent;
}

.msg-menu-icon {
  font-size: 14px;
  line-height: 1;
  color: rgba(0,0,0,.7);

  position: relative;
  top: -1px;   /* sube los puntos  */
  /* left: 1px;  si quer√©s moverlos a un lado */
}



